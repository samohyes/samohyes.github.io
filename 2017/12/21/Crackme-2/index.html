<!DOCTYPE html>
<html lang="">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Crackme: 2"/>




  <meta name="keywords" content="2017,Crackme," />





  <link rel="alternate" href="/default" title="Xudong">




  <link rel="shortcut icon" type="image/x-icon" href="/1.jpg?v=1.1" />



<link rel="canonical" href="http://samohyes.github.io/2017/12/21/Crackme-2/"/>


<meta name="description" content="This is the second post for CrackMe! Today’s sample is easy too.   User needs to input the name and serial. There is one thing to mention here that if you open ">
<meta name="keywords" content="2017,Crackme">
<meta property="og:type" content="article">
<meta property="og:title" content="Crackme: 2">
<meta property="og:url" content="http://samohyes.github.io/2017/12/21/Crackme-2/index.html">
<meta property="og:site_name" content="Xudong">
<meta property="og:description" content="This is the second post for CrackMe! Today’s sample is easy too.   User needs to input the name and serial. There is one thing to mention here that if you open this sample with IDA you probably can’t">
<meta property="og:image" content="http://samohyes.github.io/2017/12/21/Crackme-2/1.PNG">
<meta property="og:image" content="http://samohyes.github.io/2017/12/21/Crackme-2/2.PNG">
<meta property="og:image" content="http://samohyes.github.io/2017/12/21/Crackme-2/3.PNG">
<meta property="og:image" content="http://samohyes.github.io/2017/12/21/Crackme-2/4.PNG">
<meta property="og:image" content="http://samohyes.github.io/2017/12/21/Crackme-2/5.PNG">
<meta property="og:image" content="http://samohyes.github.io/2017/12/21/Crackme-2/6.PNG">
<meta property="og:updated_time" content="2017-12-21T07:49:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Crackme: 2">
<meta name="twitter:description" content="This is the second post for CrackMe! Today’s sample is easy too.   User needs to input the name and serial. There is one thing to mention here that if you open this sample with IDA you probably can’t">
<meta name="twitter:image" content="http://samohyes.github.io/2017/12/21/Crackme-2/1.PNG">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> Crackme: 2 - Xudong </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">Xudong</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>

      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Crackme: 2
        
      </h1>

      <time class="post-time">
          Dec 21 2017
      </time>
    </header>



    
            <div class="post-content">
            <p>This is the second post for CrackMe! Today’s sample is easy too.</p>
<img src="/2017/12/21/Crackme-2/1.PNG"> 
<p>User needs to input the name and serial. There is one thing to mention here that if you open this sample with IDA you probably can’t change it into graph view so here I only use Ollybdg to crack it.</p>
<p>Open Ollydbg and search in the string view you will find this.</p>
<img src="/2017/12/21/Crackme-2/2.PNG">
<p>So double click the <b><i>“You Get It”</i></b>, you will come to the important function here.</p>
<img src="/2017/12/21/Crackme-2/3.PNG"> 
<p>You have to be patient now and go up to see the code. And you come across this piece of code.</p>
<img src="/2017/12/21/Crackme-2/4.PNG">
<p>It seems that the functions use strcat to link the <b><i>“AKA-”</i></b> and something else. So go up.</p>
<img src="/2017/12/21/Crackme-2/5.PNG">
<p>Ok, this is the algorithm to generate that key. First, you have this vbaLenBstr to get the length of the name. Then multiply it by <b><i>0x17CF8</i></b>. In the <b><i>0x40242D</i></b>, it gets the ascii value for the first character of input name. Add that value to the previous multiply result. Finally, change the Hex into Decimal which is the function <b><i>“vbaStrI4”</i></b>.</p>
<p>Let’s write a simple key generator in python.</p>
<img src="/2017/12/21/Crackme-2/6.PNG">

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/2017/">2017</a>
		  
			<a href="/tags/Crackme/">Crackme</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/12/22/Android-reverse-login-traffic-analysis/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Android reverse: login traffic analysis</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2017/12/20/Malware-analysis-Dridex-and-process-hollowing/">
        <span class="next-text nav-default">Malware analysis: Dridex and process hollowing</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2018
    <span class="footer-author">Xudong.</span>
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">Total visits:<span id="busuanzi_value_site_pv"></span>times</span>
    <span class="post-meta-divider">|</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
