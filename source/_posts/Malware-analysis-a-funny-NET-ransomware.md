---
title: 'Malware analysis: a funny .NET ransomware'
date: 2017-12-24 13:06:58
tags:
- 2017
- Malware analysis
- Windows malware
---

Let’s have a look at a funny ransomware today. Before we start I have to mention that <b><i>H4rM0n1cH4cK</i></b> has already done a very good video about this malware. I am going to repeat his work and see whether we can get more.

{% youtube gKBKadVnGEw %}

First, DIE showed that the malware is packed with UPX. So we can easily unpack it.

{% asset_img 1.PNG %}

After we unpack it, we can open it with pestudio and it says that the resource area is actually a PE file.

{% asset_img 2.PNG %}

So we can strip the PE out with the HxD.

{% asset_img 3.PNG %}

The file we dumped is a .net file. There are several indications for PE file. One thing you can see is that in the directories of the file there is <b><i>“com-runtime”</i></b>. So you can open it with dnSpy. And it is easy to locate the function below.

{% asset_img 4.PNG %}

Yeah, these are the keys that you can input and unlock the screen.

{% asset_img 6.PNG %}

I also want to see the persistence method the malware uses. But I can’t find it in ProcessMonitor. And actually it copy a file here to make itself start every time the system starts.

{% asset_img 5.PNG %}
 
Ok, so why I say the malware is funny. That’s because you can simply use the task manager to close the ransomware. And sometimes I just click the unclock button without actually inputting something, it close itself too. So,haha.

Any question, please contact me at <b><i>xudong_shao@hotmail.com</b></i>
