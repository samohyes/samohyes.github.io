---
title: 'Malware analysis: a new way to stay persistence'
date: 2018-01-15 13:02:18
tags:
- 2018
- Malware analysis
- Windows malware
---

I encountered a malware using a way to stay persistence which I had never seen before. So I’d love to share it here. You can get the malware here.

http://www.malware-traffic-analysis.net/2018/01/02/index2.html

So let’s take a quick look how it stays persistence by dynamic analysis.

{% asset_img 1.PNG %}   

Yeah, it creates a task to run at 0:00 every day. So how does it do this? You can open the string subview in IDA and find this key string.

{% asset_img 2.PNG %}   

Double click it, it will leads you to the string and you can use “CTRL+x” to go to the function that achieves persistence. 
 
{% asset_img 3.PNG %}  

Ok, there we go. Here is the <b><i>schtasks</i></b> command.
Take a deep look at it.
 
{% asset_img 4.PNG %}  

You can have a better understanding at the arguments by looking at the document here.

https://msdn.microsoft.com/en-us/library/windows/desktop/bb736357(v=vs.85).aspx

But yeah, all it does is just let the malware starts at 0:00 every day.

And actually, the malware starts the browser and goes to a malicious fake website. If we check the domain we can see this.
 
{% asset_img 5.PNG %}  

That’s all for today. Any question, please contact me at <b><i>xudong_shao@hotmail.com</i></b>.

