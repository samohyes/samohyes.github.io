<!DOCTYPE html>
<html lang="">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Unpacking: using HxD"/>




  <meta name="keywords" content="2017,Unpacking," />





  <link rel="alternate" href="/default" title="秋水">




  <link rel="shortcut icon" type="image/x-icon" href="/1.jpg?v=1.1" />



<link rel="canonical" href="http://samohyes.github.io/2017/12/14/Unpacking-using-HxD/"/>


<meta name="description" content="Today, let’s unpack a malware named Fleercivet. Before we start, I have to say that the MalwareAnalysisForHegehogs has already done a quite good video tutorial ">
<meta name="keywords" content="2017,Unpacking">
<meta property="og:type" content="article">
<meta property="og:title" content="Unpacking: using HxD">
<meta property="og:url" content="http://samohyes.github.io/2017/12/14/Unpacking-using-HxD/index.html">
<meta property="og:site_name" content="秋水">
<meta property="og:description" content="Today, let’s unpack a malware named Fleercivet. Before we start, I have to say that the MalwareAnalysisForHegehogs has already done a quite good video tutorial for this sample, you can check it out he">
<meta property="og:image" content="http://samohyes.github.io/2017/12/14/Unpacking-using-HxD/1.png">
<meta property="og:image" content="http://samohyes.github.io/2017/12/14/Unpacking-using-HxD/2.png">
<meta property="og:image" content="http://samohyes.github.io/2017/12/14/Unpacking-using-HxD/3.png">
<meta property="og:image" content="http://samohyes.github.io/2017/12/14/Unpacking-using-HxD/4.png">
<meta property="og:updated_time" content="2017-12-14T12:03:28.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unpacking: using HxD">
<meta name="twitter:description" content="Today, let’s unpack a malware named Fleercivet. Before we start, I have to say that the MalwareAnalysisForHegehogs has already done a quite good video tutorial for this sample, you can check it out he">
<meta name="twitter:image" content="http://samohyes.github.io/2017/12/14/Unpacking-using-HxD/1.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> Unpacking: using HxD - 秋水 </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">秋水</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>

      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Unpacking: using HxD
        
      </h1>

      <time class="post-time">
          Dec 14 2017
      </time>
    </header>



    
            <div class="post-content">
            <p>Today, let’s unpack a malware named <b><i>Fleercivet</i></b>. Before we start, I have to say that the <b><i>MalwareAnalysisForHegehogs</i></b> has already done a quite good video tutorial for this sample, you can check it out here.</p>
<div class="video-container"><iframe src="//www.youtube.com/embed/BCis7FwffiU" frameborder="0" allowfullscreen></iframe></div>
<p>So, let’t see how we can unpack it using a different way.</p>
<p>The first part is unpacking. In the video they did quite well using the breakpoint at <b><i>VirtualAlloc</i></b> and I also write a post on this method so you can check it out too.</p>
<p><a href="http://xdshao.com/2017/12/10/Unpacking-bp-VirtualAlloc/" target="_blank" rel="noopener">http://xdshao.com/2017/12/10/Unpacking-bp-VirtualAlloc/</a></p>
<p>But for this sample, you can see that the speaker used a plugin to dump the memory and unpack it. To be honest, I can’t find the plugin and the link they provide seems not working anymore. So here, I use another way to achieve the same purpose.</p>
<p>Let’s say you follow the video and come to this step where you see at the address 0X3A0000 you find “MZ” which is the start of the PE format. To be more specific, it’s the start of the DOS header.</p>
<img src="/2017/12/14/Unpacking-using-HxD/1.png">
<p>So you open the HxD and attach it to the process in the memory which is the sample name. And then you jump to the 0x3A0000.</p>
<img src="/2017/12/14/Unpacking-using-HxD/2.png">
<p>And you can also find that, the content is in the range of 0x3A0000 to 0x3D0FFF. Because there is some meaningless things starting at 0x3D1000.</p>
<img src="/2017/12/14/Unpacking-using-HxD/3.png">
<p>So all you need to do is to copy the content between 0x3A0000 and 0x3D0FFF to a new file then save it. You can use the     PortexAnalyzer.jar to check the SHA256 and it’s the same as that in the video.</p>
<img src="/2017/12/14/Unpacking-using-HxD/4.png">
<p>Any question, please contact me at xudong_shao@hotmail.com</p>

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/2017/">2017</a>
		  
			<a href="/tags/Unpacking/">Unpacking</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/12/19/Crackme-1/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Crackme: 1</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2017/12/10/Unpacking-bp-VirtualAlloc/">
        <span class="next-text nav-default">Unpacking: bp VirtualAlloc</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2018
    <span class="footer-author">秋水.</span>

    <span class="post-meta-divider">|</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
